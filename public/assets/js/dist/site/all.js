$(document).ready((function(){var e=$("#main_content"),a=e.find(".center_content"),n=e.find(".shopping_cart"),t=n.find("#products_cart"),o=n.find(".price"),r=a.find(".btn-add-carrinho"),i=e.find(".btn-alterar-quantidade"),c=e.find(".btn-remover-produto");r.on("click",(function(e){e.preventDefault();var a=$(this).attr("data-id");$.ajax({url:"/carrinho/add/"+a,type:"POST",success:function(){$.ajax({url:"/carrinho/get",dataType:"json",success:function(e){numeral.language("pt-br"),t.html(e.numeroProdutosCarrinho),o.html(numeral(e.valorProdutosCarrinho).format("$0,0.00"))}})}})})),i.on("click",(function(e){e.preventDefault();var a=$(this).closest("tr").find(".input_quantidade").val(),n=$(this).attr("data-id");$.ajax({url:"/carrinho/update",data:"id="+n+"&qtd="+a,type:"POST",success:function(e){"semEstoque"==e&&(alert("Este produto não tem mais em estoque."),location.reload()),"updated"!=e&&"deleted"!=e||location.reload()}})})),c.on("click",(function(e){e.preventDefault();var a=$(this).attr("data-id");$.ajax({url:"/carrinho/remove",data:"id="+a,type:"POST",success:function(e){"deleted"==e&&location.reload()}})}))})),function(){var e=$("#main_content").find(".center_content"),a=e.find("#message"),n=e.find("#email_esqueci_senha");e.find("#btn-esqueci-senha").on("click",(function(e){e.preventDefault();var t=n.val();$.ajax({url:"/esqueci/send",data:"email="+t,type:"POST",beforeSend:function(){a.html("Recuperando dados, aguarde...")},success:function(e){"enviado"==e&&(a.html(""),alert("Enviado o email para redefinir a senha com sucesso!")),"user"!=e&&"erroValidate"!=e||(a.html(""),location.reload())}})}))}(),$(document).ready((function(){var e=$("#main_content").find(".center_content"),a=e.find("#btn-fechar-pedido"),n=e.find("#input-frete");a.on("click",(function(e){e.preventDefault(),$.ajax({url:"/checkout",dataType:"json",beforeSend:function(){$(a).text("Fechando pedido...")},success:function(e){console.log(e),"empty"==e&&($(a).text("Fechar Pedido"),alert("Você precisa ter algum produto no carrinho para fechar o pedido!")),"notLoggedIn"==e&&($(a).text("Fechar Pedido"),alert("Você precisa estar logado para finalizar a compra!"),window.location.href="/login"),"frete"==e&&($(a).text("Fechar Pedido"),alert("Você precisa calcular o frete para finalizar a compra!"),$(n).focus()),"erroCadastro"==e&&($(a).text("Fechar Pedido"),alert("Erro ao cadsatrar seu pedido, tente novamente!")),"sim"==e.redirecionar&&(window.location.href=e.url)}})}))})),$(document).ready((function(){var e=$("#main_content"),a=e.find("#btn-calcular-frete"),n=e.find("#input-frete"),t=e.find(".mensagem-frete");a.on("click",(function(e){e.preventDefault();var a=n.val();$.ajax({url:"/frete/calcular",type:"POST",data:"frete="+a,dataType:"json",beforeSend:function(){t.html("Calculando o frete")},success:function(e){console.log(e),"login"==e&&(window.location.href="/login"),"produto"==e&&t.html("Você precisa ter produtos no carrinho para calcular o frete."),"sim"==e.erro&&t.html(e.mensagem),"nao"==e.erro&&location.reload()}})}))})),numeral.language("pt-br",{delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){return"º"},currency:{symbol:"R$ "}});